{% extends "network/layout.html" %}

{% block body %}



<div id="initial"></div>

<script type="text/babel">

  class Userprofile extends React.Component {
    constructor(props) {
      super(props)
      this.state = {
        profile: [],
        user_id: props.user_id,
      };
    }

    render() {
      return this.state.profile;
    }

    // make a fetch to the server and get the request.user and display their info.
    profile1 = async () => {
      console.log("entrou")
      const response = await fetch('/profile/' + this.state.user_id)
      const mappingProfile = await response.json();
      console.log(mappingProfile[0])// object with data of the user.
      //return await mappingProfile[0].user;

      this.updateUserProfile(mappingProfile.map((data) => {
        return (
          <li key={data.id} className="list-group-item list-group-item-action">
            <div><h2> USER PROFILE: </h2></div>
            <div>
              <h3> Username: {data.user} <p>Email: {data.email}</p>
                <p>Date joined: {data.date_joined}</p>
              </h3>
            </div>
          </li>
        );
      }));
    }

    componentDidMount() {
      return this.profile1()
    }

    updateUserProfile = (profile) => {
      this.setState({ profile: profile })
    }


  }

  class Initial extends React.Component {
    render() {
      return (
        <div>
          <Userprofile user_id='{{user_id}}' ></Userprofile >
          <dir>PROFILE PAGE {{ user_id }}</dir>
        </div>
      );
    }
  }

  ReactDOM.render(<Initial />, document.querySelector('#initial'));

</script>
{% endblock %}