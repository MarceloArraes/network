{% extends "network/layout.html" %}

{% block body %}
TODO



<div>Teste1</div>


<div id="initial">Teste</div>



<script type="text/babel">

    //React aqui pega o conte√∫do do HTML da postagem para salvar

    class Submit_post extends React.Component {

    }

    class Timeline extends React.Component {
        render() {
            return (
                <div>
                    <div>Post list by timestamp</div>
                    <div><input onMouseDown={this.listposts} type="button" /></div>
                    <div id="postlist" ></div>
                </div>

            );
        }
        listposts = (event) => {
            // Fazer um fetch e chamar o show posts
            fetch('/showposts')
                .then(response => response.json())
                .then(data => {
                    console.log(data)
                    data.forEach(element => {
                        posting_posts(element)
                    });;
                });
            function posting_posts(posts) {

                const post = document.createElement('div');
                post.className = 'post';
                post.innerHTML = posts.content;



                document.querySelector('#postlist').append(post);
            }

        }


    }

    class Compose extends React.Component {
        constructor(props) {
            super(props);
            this.state = {
                //postuser: self.user,
                content: "",
            };
        }


        render() {
            return (
                <div>
                    <div><h2>Post:</h2></div>
                    <div><input id='content' type="text" onChange={this.updateContent} /></div>
                    <div><input onMouseDown={this.submitButtonPress} value='Submit' type="button" /></div>
                    <div>{this.state.content}</div>

                </div>

            );
        }
        submitButtonPress = (event) => {
            //const userr = this.dataset.section;
            console.log("button Clicked");
            console.log(`Content: ${this.state.content}`);
            const userr = document.querySelector('#userr').innerHTML;
            const contentt = this.state.content;
            console.log(userr)
            //if (this.state.content != "") {
            console.log("entenred the saving post")
            fetch('/posts', {
                method: 'POST',
                body: JSON.stringify({
                    //postuser: event.request.user,
                    content: contentt,
                })
            })
                .then(response => response.json())
                .then(result => {
                    console.log(result)
                });
            //} else { console.log("no content yet") }


        }
        updateContent = (event) => {
            this.setState({
                content: event.target.value
            })
        }
    }


    class Initial extends React.Component {
        render() {
            return (
                <div>
                    <Compose />
                    <dir></dir>
                    <div><Timeline /></div>
                </div>
            );
        }
    }

    ReactDOM.render(<Initial />, document.querySelector('#initial'));
</script>
{% endblock %}